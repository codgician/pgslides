<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="ver 0309-hotfix1 未完成">
  <title>浅谈置换群</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="https://revealjs.com/css/reset.css">
  <link rel="stylesheet" href="https://revealjs.com/css/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="https://revealjs.com/css/theme/black.css" id="theme">
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match( /print-pdf/gi ) ? 'https://revealjs.com/css/print/pdf.css' : 'https://revealjs.com/css/print/paper.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  </script>
  <!--[if lt IE 9]>
  <script src="https://revealjs.com/lib/js/html5shiv.js"></script>
  <![endif]-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      fleqn: false
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" />
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">浅谈置换群</h1>
  <p class="author">ver 0309-hotfix1 未完成</p>
  <p class="date">2020.03</p>
</section>

<section>
<section id="group" class="title-slide slide level1">
<h1>群 <span class="math inline">(G, \cdot)</span></h1>
<p><span class="math inline">G</span> 是非空集合，且二元运算满足：</p>
<ul>
<li>结合律：<span class="math inline">(a \cdot b) \cdot c = a \cdot (b \cdot c)</span></li>
<li>单位元 <span class="math inline">e</span>：<span class="math inline">\forall a \in G, \ ea = ae = a</span></li>
<li>逆元：<span class="math inline">\forall a \in G, \ \exist b \in G \text{ \ s.t. \ } ab = ba = e</span></li>
</ul>
<div class="fragment">
<p>若满足交换律，则为<strong>交换群</strong></p>
</div>
</section>
<section class="slide level2">

<ul>
<li>左右逆元相等：
<ul>
<li><p>设 <span class="math inline">x</span> 是 <span class="math inline">a</span> 的左逆元，<span class="math inline">y</span> 是 <span class="math inline">a</span> 的右逆元，有：</p>
<p><span class="math display">
x = xe = x(ay) = (xa)y = y
</span></p></li>
</ul></li>
<li>满足消去律：
<ul>
<li><span class="math inline">\forall a, b, c \in G, \ ab = ac \Leftrightarrow b = c</span></li>
</ul></li>
</ul>
<aside class="notes">
<p>只要逆元存在就满足消去律：两边都乘上 <span class="math inline">a^{-1}</span> 即可。</p>
</aside>
</section>
<section id="subgroup" class="slide level2">
<h2>子群</h2>
<p>设 <span class="math inline">(G, \cdot)</span> 为群，<span class="math inline">H</span> 是 <span class="math inline">G</span> 的子集，若 <span class="math inline">(H, \cdot)</span> 成群，则称 <span class="math inline">H</span> 为 <span class="math inline">G</span> 的子群，记作 <span class="math inline">H \le G</span>；</p>
</section></section>
<section>
<section id="relation" class="title-slide slide level1">
<h1>关系</h1>
<ul>
<li>集合的<strong>笛卡尔积 (Cartesian product)</strong>： <span class="math display">
A \times B = \left\{ (a, b) \mid a \in A, b \in B \right\}
</span></li>
<li>设 <span class="math inline">A</span> 是集合，集合 <span class="math inline">A \times A</span> 的每个子集 <span class="math inline">R</span> 叫做集合 <span class="math inline">A</span> 上的一个<strong>关系 (relation)</strong>。</li>
<li>若 <span class="math inline">(a, b) \in R</span>，则称 <span class="math inline">a</span> 和 <span class="math inline">b</span> 有关系 <span class="math inline">R</span>，记作 <span class="math inline">aRb</span>。</li>
</ul>
</section>
<section id="equivalence-relation" class="slide level2">
<h2>等价关系</h2>
<p>若集合 <span class="math inline">A</span> 上的关系 <span class="math inline">\sim</span> 满足如下条件：</p>
<ul>
<li><strong>自反性</strong>：<span class="math inline">\forall a \in A</span>，<span class="math inline">a \sim a</span>；</li>
<li><strong>对称性</strong>：<span class="math inline">\forall a, b \in A</span>，若 <span class="math inline">a \sim b</span> 则 <span class="math inline">b \sim a</span>；</li>
<li><strong>传递性</strong>：<span class="math inline">\forall a, b \in A</span>，若 <span class="math inline">a \sim b, \ b \sim c</span>，则 <span class="math inline">a \sim c</span>；</li>
</ul>
<p>则称 <span class="math inline">\sim</span> 是<strong>等价关系 (equivalence relation)</strong>。</p>
<aside class="notes">
<p>举个例子：<span class="math inline">a \sim b := a \equiv b \pmod 7</span></p>
<p>这就是个等价关系（试着验证一下？）。</p>
</aside>
</section></section>
<section>
<section id="equivalence-class" class="title-slide slide level1">
<h1>等价类</h1>
<p>设 <span class="math inline">\sim</span> 是 <span class="math inline">A</span> 上的等价关系，<span class="math inline">\forall a \in A</span>，<span class="math inline">[a]</span> 表示 <span class="math inline">A</span> 中与 <span class="math inline">a</span> 等价的全部元素构成的集合：</p>
<p><span class="math display">
[a] = \left\{ b \in A \mid b \sim a \right\}
</span></p>
<p>称 <span class="math inline">[a]</span> 为 <span class="math inline">a</span> 所在的<strong>等价类 (equivalence class)</strong>。</p>
</section>
<section class="slide level2">

<p><strong>若 <span class="math inline">a, b \in A</span> 且 <span class="math inline">[a] \cap [b] \neq \emptyset</span>，则 <span class="math inline">[a] = [b]</span>。</strong></p>
<div class="fragment fade-in-then-out" style="height:0">
<ul>
<li>假设 <span class="math inline">k_1 \in [a]</span> 且 <span class="math inline">k_1 \notin [b]</span>，<span class="math inline">k_2 \in [a] \cap [b]</span>；</li>
<li>则有 <span class="math inline">k_1 \sim a, \ k_2 \sim a, \ k_2 \sim b</span>；</li>
<li>由传递性得 <span class="math inline">k_1 \sim b</span>，与假设不符。</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>集合 <span class="math inline">A</span> 可看作一些两两不相交的等价类的并： <span class="math display">
A = \bigcup\limits_{a \in R} [a] \text{（两两不相交之并）}
</span></li>
<li><span class="math inline">A</span> 上的每个等价关系给出集合 <span class="math inline">A</span> 的一个<strong>划分 (partition)</strong>。</li>
</ul>
</div>
<aside class="notes">
<p>关于 <span class="math inline">R</span>，事实上是完全代表系，由等价类 <span class="math inline">[a_i]</span> 中选出一个元素构成，使得 <span class="math inline">A</span> 中每个元素都与 <span class="math inline">R</span> 中的某个元素等价，同时 <span class="math inline">R</span> 中的元素彼此不等价。</p>
<p>对于划分的定义：若 <span class="math inline">A</span> 是它的某些子集 <span class="math inline">\{ A_i | i \in I \}</span> 之并，且 <span class="math inline">A_i</span> 两两不交，则称其为集合 <span class="math inline">A</span> 的一个划分（或分拆）。</p>
<p>我们可以看到，引入等价类的意义就是为了对集合中的元素进行某种程度上的分类。后面要介绍的轨道、陪集等本质上都是基于等价关系的。</p>
</aside>
</section></section>
<section>
<section id="coset" class="title-slide slide level1">
<h1>陪集</h1>
<p>设 <span class="math inline">H \leq G</span>，对于 <span class="math inline">x \in G</span>：</p>
<ul>
<li><span class="math inline">H</span> 的一个<strong>左陪集 (left coset)</strong> <span class="math inline">xH</span>： <span class="math display">
xH = \{ x \cdot h \mid h \in H \}
</span></li>
<li><span class="math inline">H</span> 的一个<strong>右陪集 (right coset)</strong> <span class="math inline">Hx</span>： <span class="math display">
Hx = \{ h \cdot x \mid h \in H \}
</span></li>
</ul>
<aside class="notes">
<p>由于左右陪集相关内容是相似的，所以接下来只会分析左陪集。</p>
</aside>
</section>
<section class="slide level2">

<p><span class="math display">
\begin{aligned}
xH &amp; = \{ x \cdot h \mid h \in H \} \\
Hx &amp; = \{ h \cdot x \mid h \in H \}
\end{aligned}
</span></p>
<div class="fragment">
<ul>
<li><strong>自反性</strong>：<span class="math inline">x \in xH</span>；</li>
<li><strong>对称性</strong>：若 <span class="math inline">y \in xH</span>，则 <span class="math inline">x \in yH</span>；</li>
<li><strong>传递性</strong>：若 <span class="math inline">z \in yH, \ y \in xH</span>，则 <span class="math inline">z \in xH</span>。</li>
</ul>
</div>
<aside class="notes">
<p>注意陪集不一定是 <span class="math inline">G</span> 的一个子群。</p>
<p>💡 提示:</p>
<ol type="1">
<li>既然 <span class="math inline">H</span> 还是群，那么肯定有单位元；</li>
<li>既然 <span class="math inline">H</span> 中逆元存在，有 <span class="math inline">y = x \cdot h</span>， 自然有 <span class="math inline">x = y \cdot h^{-1}</span> 且 <span class="math inline">h^{-1} \in H</span>；</li>
<li><span class="math inline">z = y \cdot h_1, \ y = x \cdot h_2 \Rightarrow z = x \cdot h_2h_1</span>，又 <span class="math inline">h_2h_1 \in H</span>，自然得证。</li>
</ol>
</aside>
</section>
<section class="slide level2">

<ul>
<li><p>若 <span class="math inline">xH \cap yH \neq \emptyset</span>，则 <span class="math inline">xH = yH</span>；</p></li>
<li><p>利用陪集可以对群 <span class="math inline">G</span> 进行划分：</p>
<p><span class="math display">
G = \bigcup\limits_{g \in R} gH \text{（两两不相交之并）}
</span></p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>对于 <span class="math inline">a, b \in H</span>，由消去律 <span class="math inline">a \neq b \Leftrightarrow ag \neq bg</span>；</li>
<li>因此，<span class="math inline">\forall g \in R, \ \mid gH \mid = \mid H \mid</span>: <span class="math display">
\mid G \mid = \sum\limits_{g \in R} \mid gH \mid 
= \sum\limits_{g \in R} \mid A \mid 
= \mid R \mid \cdot \mid H \mid
</span></li>
</ul>
<aside class="notes">
<p>利用群 <span class="math inline">G</span> 的一个子群 <span class="math inline">H</span>，我们可以把利用陪集对 <span class="math inline">G</span> 进行划分。换句话说，群 <span class="math inline">G</span> 一定可以表示成若干个 <span class="math inline">H</span> 的互不相交的左（右）陪集之并，而这些陪集的大小都是相同的。形象地理解，就是我们能够把 <span class="math inline">G</span> 划分成大小相等的若干部分。</p>
<p>把 <span class="math inline">\mid R \mid</span> 记作群 <span class="math inline">H</span> 对群 <span class="math inline">G</span> 的指数 <span class="math inline">[G : H]</span>，就可以得到拉格朗日定理……</p>
</aside>
</section></section>
<section id="lagrange-theorem" class="title-slide slide level1">
<h1>拉格朗日定理</h1>
<p>设 <span class="math inline">G</span> 为有限群，<span class="math inline">H \leq G</span>，则：</p>
<p><span class="math display">
\mid G \mid = [G : H] \cdot \mid H \mid
</span></p>
<p>其中 <span class="math inline">[G : H]</span> 称为群 <span class="math inline">H</span> 对于群 <span class="math inline">G</span> 的<strong>指数 (index)</strong>。</p>
<aside class="notes">
<p>说明 G 的子群 H 的大小一定是 G 大小的因子。</p>
</aside>
</section>

<section>
<section id="permutation" class="title-slide slide level1">
<h1>置换</h1>
<p>一个集合的<strong>置换 (permutation)</strong> 即从该集合映射至自身的双射。</p>
<p><span class="math display">
\sigma = 
\left(\begin{array}{c}
1 &amp; 2 &amp; \dots &amp; n \\
\sigma(1) &amp; \sigma(2) &amp; \dots &amp; \sigma(n)
\end{array}\right)
</span></p>
<p>复合运算: <span class="math inline">(f \circ g)(x) = f(g(x))</span></p>
</section>
<section id="例" class="slide level2">
<h2>例</h2>
<p><span class="math display">
\left(\begin{array}{c} 
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 \\ 
4 &amp; 5 &amp; 1 &amp; 3 &amp; 6 &amp; 2 
\end{array}\right)
</span></p>
<div class="fragment">
<p><span class="math display">
\begin{aligned}
1 &amp; \rightarrow 4 \rightarrow 3 \\
2 &amp; \rightarrow 5 \rightarrow 6
\end{aligned}
</span></p>
<p>任一置换都能被划分成若干不交的映射链？</p>
</div>
<aside class="notes">
<p>如果可以的话，这就意味着我们发现了一种能够更简单表示置换的方式（也就是后面要介绍的轮换表示法）。</p>
</aside>
</section>
<section id="轮换表示法" class="slide level2">
<h2>轮换表示法</h2>
<p><span class="math display"> 
\left(\begin{array}{c}
a_1 &amp; a_2 &amp; \dots &amp; a_n \\
a_2 &amp; a_3 &amp; \dots &amp; a_1
\end{array}\right) \xRightarrow{\text{记作}} (a_1 \enspace a_2 \enspace \dots \enspace a_n)
</span></p>
</section>
<section id="例-1" class="slide level2">
<h2>例</h2>
<p><span class="math display">
\left(\begin{array}{c} 
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 \\ 
4 &amp; 5 &amp; 1 &amp; 3 &amp; 6 &amp; 2 
\end{array}\right)
= (1 \enspace 4 \enspace 3) \cdot (2 \enspace 5 \enspace 6)
</span></p>
<div class="fragment">
<p><strong>若不计轮换内外的次序，对于任意置换的不交轮换分解是唯一的吗？</strong></p>
</div>
<aside class="notes">
<p>显然不交的轮换在复合时是满足交换律的，但是如果两个轮换相交就不好说了，例如试试计算 (1 2 3) * (3 4) 是否等于 (3 4) * (1 2 3)。</p>
</aside>
</section>
<section class="slide level2">

<h3 id="证明">证明</h3>
<p>考虑一个 <span class="math inline">n</span> 元置换</p>
<ul>
<li>对于恒等置换，显然分解是唯一的；</li>
<li>对于非恒等置换，<span class="math inline">\exist i \text{ \ s.t. \ } \sigma(i) \neq i</span>。</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><span class="math inline">i \rightarrow \sigma(i) \rightarrow \sigma^2(i) \rightarrow \dots</span></li>
<li>由抽屉原理，<span class="math inline">\exist t_1 &lt; t_2 \text{ \ s.t. \ } \sigma^{t_1}(i) = \sigma^{t_2}(i)</span></li>
<li>令 <span class="math inline">t</span> 为使得 <span class="math inline">\sigma^t(i) = i</span> 的最小正整数，则： <span class="math display">
(i \enspace \sigma(i) \enspace \dots \enspace \sigma^{t - 1}(i))
</span> 是一个轮换。</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>对于每个这样的 <span class="math inline">i</span> 都如此操作即可构造出一个唯一的不相交轮换分解式：
<ul>
<li>每个元素在分解式中恰好出现 <span class="math inline">1</span> 次；</li>
<li>每个元素所属于的轮换是固定的。</li>
</ul></li>
</ul>
</section>
<section id="power-of-cyclic-permutation" class="slide level2">
<h2>循环置换的幂运算</h2>
<div class="fragment current-visible" style="height:0">
<p><span class="math display">
(1 \enspace 2 \enspace 3 \enspace 4 \enspace 5 \enspace 6)
</span></p>
</div>
<aside class="notes">
<p>循环置换就是最多只能被分解成一个不含重复元素的轮换的置换。</p>
</aside>
<div class="fragment fade-in-then-out" style="height:0">
<p><span class="math display">
\begin{aligned}
&amp; (1 \enspace 2 \enspace 3 \enspace 4 \enspace 5 \enspace 6)^2 \\
&amp; = (1 \enspace 3 \enspace 5) \cdot (2 \enspace 4 \enspace 6)
\end{aligned}
</span></p>
</div>
<div class="fragment fade-in-then-out" style="height:0">
<p><span class="math display">
\begin{aligned}
&amp; (1 \enspace 2 \enspace 3 \enspace 4 \enspace 5 \enspace 6)^3 \\
&amp; =  (1 \enspace 4) \cdot (2 \enspace 5) \cdot (3 \enspace 6)
\end{aligned}
</span></p>
</div>
<div class="fragment fade-in-then-out" style="height:0">
<p><span class="math display">
\begin{aligned}
&amp; (1 \enspace 2 \enspace 3 \enspace 4 \enspace 5 \enspace 6)^4 \\
&amp; = (1 \enspace 5 \enspace 3) \cdot (2 \enspace 6 \enspace 4)
\end{aligned}
</span></p>
</div>
</section>
<section class="slide level2">

<p><span class="math display">
\sigma = (a_0 \enspace a_1 \enspace \dots \enspace a_{n - 1})
</span></p>
<ul>
<li><span class="math inline">\sigma^t(a_i) = a_{[(i + t) \bmod n]}</span></li>
<li>令 <span class="math inline">k \in N^{*} \text{ \ s.t. \ } \sigma^{tk}(a_i) = a_i</span>：</li>
</ul>
<div class="fragment current-visible" style="height:0">
<p><span class="math display">
i + tk \equiv i \pmod n
</span></p>
</div>
<div class="fragment">
<p><span class="math display">
tk \equiv 0 \pmod n
</span></p>
<p>最小非负解：<span class="math inline">k = \frac{n}{\gcd(n, t)}</span></p>
</div>
</section>
<section class="slide level2">

<p><span class="math display">
\sigma = (a_0 \enspace a_1 \enspace \dots \enspace a_{n - 1})
</span></p>
<ul>
<li><span class="math inline">\sigma^t</span> 可表示为 <span class="math inline">\gcd(n, t)</span> 个长为 <span class="math inline">\frac{n}{\gcd(n, t)}</span> 的轮换；</li>
<li>对于第 <span class="math inline">i</span> 个轮换 <span class="math inline">c&#39;_i</span>： <span class="math display">
c&#39;_i[j] = c[(i + ej) \bmod n]
</span></li>
</ul>
<p>借助这一性质可以 <span class="math inline">\mathcal{O}(N)</span> 求得任一置换的幂。</p>
</section></section>
<section id="permutation-group" class="title-slide slide level1">
<h1>置换群</h1>
<p><span class="math inline">n</span> 个元的所有置换，在复合运算 <span class="math inline">\circ</span> 下成群，称作 <span class="math inline">n</span> 元<strong>对称群</strong> <span class="math inline">S_n</span></p>
<ul>
<li>结合律：<span class="math inline">(f \circ g) \circ h = f \circ (g \circ h)</span></li>
<li>单位元：恒等置换 <span class="math inline">\epsilon \circ x = x</span>；</li>
<li>逆元显然存在。</li>
</ul>
<aside class="notes">
<p>对于结合律的进一步说明：等式两边都是 f(g(h(x)))</p>
</aside>
</section>

<section id="group-action" class="title-slide slide level1">
<h1>群在集合上的作用</h1>
<p>设 <span class="math inline">G</span> 是一个群，<span class="math inline">M</span> 是一个集合。若 <span class="math inline">G</span> 中每个元 <span class="math inline">\sigma</span> 都对应于 <span class="math inline">M</span> 的一个变换，对 <span class="math inline">\forall m \in M</span> 记变换结果为 <span class="math inline">\sigma \circ m</span>，且满足：</p>
<ul>
<li><span class="math inline">\exist e \text{ \ s.t. \ } \forall m \in M, \ e \circ m = m</span>；</li>
<li><span class="math inline">\forall \tau, \sigma \in G, \ (\tau\sigma) \circ m = \tau \circ (\sigma \circ m)</span></li>
</ul>
<p>则称 <span class="math inline">G</span> 在 <span class="math inline">M</span> 上有<strong>群作用 (group action)</strong>。</p>
<aside class="notes">
<p>其实任意群斗都与某个置换群同构，但是碍于主题，这里不会展开讲。对于后续所讲述的群都可默认为置换群。</p>
</aside>
</section>

<section>
<section id="orbit" class="title-slide slide level1">
<h1>轨道</h1>
<p>群 <span class="math inline">G</span> 作用于集合 <span class="math inline">M</span> 上，<span class="math inline">x \in M</span>，称 <span class="math inline">M</span> 的子集</p>
<p><span class="math display">
\text{orb}_G(x) = \{ \sigma \circ x \mid \sigma \in G \}
</span></p>
<p>为 <span class="math inline">x</span> 在 <span class="math inline">G</span> 作用下的<strong>轨道 (orbit)</strong>，简称过 <span class="math inline">x</span> 的轨道。</p>
<aside class="notes">
<p>其实本质上就是等价类…… 部分地方记作 <span class="math inline">\mathcal{O}_G(x)</span>，也有的地方直接用等价类的符号 <span class="math inline">[x]</span>。</p>
</aside>
</section>
<section class="slide level2">

<p><span class="math display">
\text{orb}_G(x) = \{ \sigma \circ x \mid \sigma \in G \}
</span></p>
<ul>
<li><strong>自反性</strong>：<span class="math inline">x \in \text{orb}_G(x)</span>；</li>
<li><strong>对称性</strong>：若 <span class="math inline">y \in \text{orb}_G(x)</span>，则 <span class="math inline">x \in \text{orb}_G(y)</span>；</li>
<li><strong>传递性</strong>：若 <span class="math inline">z \in \text{orb}_G(y), y \in \text{orb}_G(x)</span>，则 <span class="math inline">z \in \text{orb}_G(x)</span>。</li>
</ul>
<aside class="notes">
<p>定义关系 <span class="math inline">x \sim y := x \in \text{orb}_G(y)</span>，那么这是一个等价关系~</p>
<p>💡 提示:</p>
<ol type="1">
<li>既然是置换群，必然有恒等置换；</li>
<li>既然置换群中逆元存在，有能把 x 变成 y 的置换则一定也有能把 y 变成 x 的置换；</li>
<li>既然置换群中的运算封闭，若有置换能使 x -&gt; y，另一置换能使 y -&gt; z，则一定有一个置换能使 x -&gt; z。</li>
</ol>
</aside>
</section>
<section class="slide level2">

<ul>
<li><p>若 <span class="math inline">\text{orb}_G(x) \cap \text{orb}_G(y) \neq \emptyset</span>，则 <span class="math inline">\text{orb}_G(x) = \text{orb}_G(y)</span>；</p></li>
<li><p>在 <span class="math inline">M</span> 的每一条轨道上取一个元素组成 <span class="math inline">M</span> 的一个子集 <span class="math inline">R</span>，称为 <span class="math inline">M</span> 的<strong>轨道的代表元集</strong>，则：</p>
<p><span class="math display">
M = \bigcup\limits_{x \in R} \text{orb}_G(x)
</span></p>
<p>并且此中各 <span class="math inline">\text{orb}_G(x)</span> 互不相交。</p></li>
</ul>
</section>
<section class="slide level2">

<h3 id="whats-the-meaning">求轨道数量？</h3>
<div class="fragment">
<p>解决一类求本质不同方案个数的问题！</p>
</div>
</section>
<section class="slide level2">

<ul>
<li>在等边三角形顶点上染色，可得到多少本质不同的三角形？</li>
</ul>
<div class="fragment fade-in-then-out" style="height:0">
<figure>
<img data-src="./assets/meaning-example-01.png" class="plain" alt="" /><figcaption>在旋转意义下同构</figcaption>
</figure>
</div>
<div class="fragment fade-in-then-out" style="height:0">
<figure>
<img data-src="./assets/meaning-example-02.png" class="plain" alt="" /><figcaption>在翻转意义下同构</figcaption>
</figure>
</div>
<div class="fragment">
<p><span class="math display">
\begin{aligned}
G_1 &amp; = \{ \text{顺时针旋转 } 120^\circ, 240^\circ, 360^\circ \} \\
G_2 &amp; = \{ \text{ 不翻转、沿着过 $0, 1, 2$ 的对称轴翻转 } \} \\
M &amp; = \{ 所有不考虑同构下不同的染色方案 \}
\end{aligned}
</span></p>
<p><span class="math inline">G_1 \cup G_2</span> 作用于 <span class="math inline">M</span> 后，轨道数即为所求答案。</p>
</div>
<aside class="notes">
<p>一个很<strong>关键</strong>的问题：试着验证一下为什么 <span class="math inline">G_1 \cup G_2</span> 依然是一个群。</p>
<p>后面还会讲到这个模型，到时候会进行一个说明。但是希望大家在此处能够注意到这一问题，并加以思考。</p>
<p>接下来我们要考虑的就是如何求轨道数了。</p>
</aside>
</section></section>
<section>
<section id="stabilizer" class="title-slide slide level1">
<h1>稳定子</h1>
<p>设群 <span class="math inline">G</span> 作用于集合 <span class="math inline">M</span>，对 <span class="math inline">x \in M</span>，称</p>
<p><span class="math display">
\text{stab}_G(x) = \{ \sigma \in G \mid \sigma \circ x = x \}
</span></p>
<p>为群 <span class="math inline">G</span> 作用下 <span class="math inline">x</span> 的<strong>稳定子 (stabilizer)</strong>。</p>
<aside class="notes">
<p>又称固定子群、稳定子群、稳定化子…… 有的地方也写成 <span class="math inline">G_m</span> 或 <span class="math inline">G^m</span>。</p>
</aside>
</section>
<section class="slide level2">

<p><span class="math display">
\text{stab}_G(x) = \{ \sigma \in G \mid \sigma \circ x = x \} \le G
</span></p>
<div class="fragment">
<ul>
<li><strong>封闭性</strong>：<span class="math inline">\forall \sigma, \tau \in \text{stab}_G(x)</span>，<span class="math inline">\sigma \circ \tau \circ x = \sigma \circ x = x</span>，故 <span class="math inline">(\sigma \circ \tau) \in \text{stab}_G(x)</span>；</li>
<li><strong>结合律</strong>：显然置换的复合满足结合律；</li>
<li><strong>单位元</strong>：恒等置换 <span class="math inline">\epsilon \circ x = x</span>；</li>
<li><strong>逆元</strong>：<span class="math inline">\forall \sigma \in \text{stab}_G(x)</span>，<span class="math inline">\sigma^{-1} \circ x = \sigma^{-1} \circ (\sigma \circ x) = \epsilon(x) = x</span>。</li>
</ul>
</div>
</section>
<section class="slide level2">

<p><span class="math display">
\text{stab}_G(x) = \{ \sigma \in G \mid \sigma \circ x = x \} \le G
</span></p>
<div class="fragment current-visible" style="height:0">
<ul>
<li>既然是子群，那可以用来对 <span class="math inline">G</span> 进行左陪集划分；</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\beta \text{stab}_G(x)</span> 里的元素相当于作用于 <span class="math inline">x</span> 时 <span class="math inline">G</span> 中所有与 <span class="math inline">\beta</span> 等价的置换： <span class="math display">
\beta \text{stab}_G(x) = \{ \tau \in G \mid \tau \circ x = \beta \circ x \}
</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="math inline">\text{orb}_G(x) = \{ \sigma \circ x \mid \sigma \in G \}</span> 表示作用于 <span class="math inline">x</span> 时互不等价的置换，即上述不同左陪集的数量。</li>
</ul>
</div>
<aside class="notes">
<p><span class="math inline">\beta \text{stab}_G(x)</span> 里面的元素相当于 <span class="math inline">G</span> 中与 <span class="math inline">\beta</span> 等价的置换；那么陪集的数量就代表本质不同的置换的个数…… 这不就是轨道数吗~</p>
<p>想想拉格朗日定理…… 于是我们便得到了轨道-稳定子定理。</p>
</aside>
</section>
<section id="orbit-stabilizer-theorem" class="slide level2">
<h2>轨道-稳定子定理</h2>
<p>设有限群 <span class="math inline">G</span> 作用于集合 <span class="math inline">M</span> ，<span class="math inline">x \in M</span>，则：</p>
<p><span class="math display">
\mid G \mid = \mid \text{stab}_G(x) \mid \cdot \mid \text{orb}_G(x) \mid
</span></p>
</section></section>
<section>
<section id="burnside-lemma" class="title-slide slide level1">
<h1>Burnside 引理</h1>
<p>设有限群 <span class="math inline">G</span> 作用于有限集 <span class="math inline">M</span> 上，则轨道数：</p>
<p><span class="math display">
\mid M / G \mid = \frac{1}{\mid G \mid} \sum\limits_{\sigma \in G} |\text{fix}(\sigma)|
</span></p>
<p>其中 <span class="math inline">\text{fix}(\sigma)</span> 代表 <span class="math inline">\sigma</span> 的不动元构成的集合：</p>
<p><span class="math display">
\text{fix}(\sigma) = \{ x \in M \mid \sigma \circ x = x \}
</span></p>
</section>
<section id="proof-of-burnside-lemma-1" class="slide level2">
<h2>证明</h2>
<p><span class="math display">
\begin{aligned}
\text{stab}_G(x) &amp; = \{ \sigma \in G \mid \sigma \circ x = x \}\\
\text{fix}(\sigma) &amp; = \{ x \in M \mid \sigma \circ x = x \}
\end{aligned}
</span></p>
<p><span class="math display">
\sum\limits_{x \in M} \mid \text{stab}_G(x) \mid = \sum\limits_{\sigma \in G} \mid \text{fix}(\sigma) \mid
</span></p>
<aside class="notes">
<p>稳定子是固定 <span class="math inline">x</span> 找 <span class="math inline">\sigma</span>，而不动元是固定 <span class="math inline">\sigma</span> 找 <span class="math inline">m</span>，故对于下面的等式两边本质上只是换了一下遍历的顺序。</p>
</aside>
</section>
<section id="proof-of-burnside-lemma-2" class="slide level2">
<h2>证明</h2>
<div class="fragment current-visible" style="height:0">
<ul>
<li>每个轨道对答案的贡献为 <span class="math inline">1</span>，故元素 <span class="math inline">x \in M</span> 对答案的贡献为 <span class="math inline">\frac{1}{\mid \text{orb}_G(x) \mid}</span>；</li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">
  \begin{aligned}
  \mid M / G \mid 
  &amp; = \sum\limits_{x \in M} \frac{1}{ \mid \text{orb}_G(x) \mid } \\
  &amp; = \sum\limits_{x \in M}\frac{ \mid \text{stab}_G(x) \mid }{ \mid G \mid } \text{（轨道-稳定子定理）} \\
  &amp; = \frac{1}{\mid G \mid}\sum\limits_{\sigma \in G} \mid \text{fix}(\sigma) \mid
  \end{aligned}
</span></p>
</div>
</section>
<section id="bs-example" class="slide level2">
<h2>例子</h2>
<p>对正六边形的 <span class="math inline">6</span> 个顶点，一半涂黑色一半涂白色。若经过旋转可相互得到的方案算同一种方案，求染色方案数？</p>
</section>
<section class="slide level2">

<h3 id="分析">分析</h3>
<p><span class="math display">
M = \text{所有涂色方案， 共：} \binom{6}{3} = 20 \text{ 种}
</span></p>
<p><span class="math display">
G = \{ 60^\circ, 120^\circ, 180^\circ, 240^\circ, 300^\circ, 360^\circ \} \\
\text{（绕中心顺时针旋转）}
</span></p>
<p>记 <span class="math inline">6</span> 个顶点分别为 <span class="math inline">A_1, A_2, \dots, A_6</span>。</p>
</section>
<section class="slide level2">

<h3 id="旋转-360circ">旋转 <span class="math inline">360^\circ</span></h3>
<p><span class="math display">
\left(\begin{array}{c} 
A_1 &amp; A_2 &amp; A_3 &amp; A_4 &amp; A_5 &amp; A_6 \\ 
A_1 &amp; A_2 &amp; A_3 &amp; A_4 &amp; A_5 &amp; A_6 
\end{array}\right)
</span></p>
<p>将这一置换作用于 <span class="math inline">M</span> 中的任意元素都不会使该元素发生变化，故不动元有 <span class="math inline">20</span> 个。</p>
</section>
<section class="slide level2">

<h3 id="旋转-60circ">旋转 <span class="math inline">60^\circ</span></h3>
<p><span class="math display">
\left(\begin{array}{c} 
A_1 &amp; A_2 &amp; A_3 &amp; A_4 &amp; A_5 &amp; A_6 \\ 
A_6 &amp; A_1 &amp; A_2 &amp; A_3 &amp; A_4 &amp; A_5 
\end{array}\right)
</span></p>
<p>若要成为不动元，则应当满足：</p>
<p><span class="math display">
A_1 = A_2 = \dots = A_6
</span></p>
<p>故没有不动元</p>
</section>
<section class="slide level2">

<h3 id="旋转-120circ">旋转 <span class="math inline">120^\circ</span></h3>
<p><span class="math display">
\left(\begin{array}{c} 
A_1 &amp; A_2 &amp; A_3 &amp; A_4 &amp; A_5 &amp; A_6 \\ 
A_5 &amp; A_6 &amp; A_1 &amp; A_2 &amp; A_3 &amp; A_4 
\end{array}\right)
</span></p>
<p>若要成为不动元，则应当满足：</p>
<p><span class="math display">
A_1 = A_3 = A_5, \ A_2 = A_4 = A_6
</span></p>
<p>故不动元数量为 <span class="math inline">2</span></p>
</section>
<section class="slide level2">

<h3 id="旋转-180circ">旋转 <span class="math inline">180^\circ</span></h3>
<p><span class="math display">
\left(\begin{array}{c} 
A_1 &amp; A_2 &amp; A_3 &amp; A_4 &amp; A_5 &amp; A_6 \\ 
A_4 &amp; A_5 &amp; A_6 &amp; A_1 &amp; A_2 &amp; A_3 
\end{array}\right)
</span></p>
<p>若要成为不动元，则应当满足：</p>
<p><span class="math display">
A_1 = A_4, \ A_2 = A_5, \ A_3 = A_6
</span></p>
<p>故没有不动元</p>
</section>
<section class="slide level2">

<ul>
<li>旋转 <span class="math inline">60^\circ</span> 与 旋转 <span class="math inline">300^\circ</span> 情形相似；</li>
<li>旋转 <span class="math inline">120^\circ</span> 与 旋转 <span class="math inline">240^\circ</span> 情形相似。</li>
</ul>
<p>轨道数：<span class="math inline">\frac{1}{6}(20 + 2 + 2) = 4</span></p>
</section></section>
<section id="polya-enumeration-theorem" class="title-slide slide level1">
<h1>Pólya 计数定理</h1>
<ul>
<li><p>将置换表示为若干轮换乘积，若轮换内元素颜色均相同即为不动元……</p></li>
<li><p>记用于染色的颜色集合为 <span class="math inline">C</span>， <span class="math inline">c(\sigma)</span> 为置换 <span class="math inline">\sigma</span> 被分解为不交轮换乘积的个数，则：</p>
<div class="fragment current-visible" style="height:0">
<p><span class="math display">
\text{fix}(\sigma) = \mid C \mid^{c(\sigma)}
</span></p>
</div>
<div class="fragment">
<p><span class="math display">
\mid M / G \mid = \frac{1}{\mid G \mid} \sum\limits_{\sigma \in G} \mid C \mid^{c(\sigma)}
</span></p>
</div></li>
</ul>
<aside class="notes">
<p>前面讲到了置换 <span class="math inline">\sigma</span> 可以被拆成若干个长度相等的映射链，也就是若干个大小相等的轮换。考虑在原始的（不考虑同构）的染色方案集合里，什么样的元素会成为置换 <span class="math inline">\sigma</span> 的下的不动元？</p>
<p>是不是只要每个轮换内的点我染的颜色都一样，那么是不是就成为不动元了…… 那么根据乘法原理就可以得到 Polya 计数定理了。</p>
</aside>
</section>

<section>
<section id="coloring-necklace" class="title-slide slide level1">
<h1>项链染色</h1>
<p>长为 <span class="math inline">n</span> 的环，<span class="math inline">m</span> 种颜色对环上元素染色，经旋转或翻转都算作相同方案</p>
<p><span class="math inline">n, m \le 10^9</span></p>
<aside class="notes">
<p>这里将之前对多边形顶点染色问题一般化。</p>
</aside>
</section>
<section class="slide level2">

<p><span class="math display">
\begin{aligned}
G_1 &amp; = \{ \text{顺时针旋转} \frac{2\pi}{n}, \dots, (n - 1)\frac{2\pi}{n}, 2\pi \} \\
G_2 &amp; = \{ \text{过每一条对称轴的翻转 } \} \\
M &amp; = \{ \text{不考虑同构的所有染色方案}  \}
\end{aligned}
</span></p>
<p><span class="math inline">G = G_1 \cap G_2</span> 作用于 <span class="math inline">M</span></p>
<div class="fragment">
<p><span class="math display">
\mid G \mid = \mid G_1 \mid + \mid G_2 \mid ?
</span></p>
</div>
</section>
<section class="slide level2">

<p>若将环上的元素按顺时针编号：<span class="math inline">0, 1, \dots (n - 1)</span></p>
<ul>
<li>顺时针旋转 <span class="math inline">k \frac{2\pi}{n}</span>：<span class="math inline">\sigma_k(i) = (i + k) \bmod n</span>；</li>
<li>沿过点 <span class="math inline">a</span> 的对称轴翻转： <span class="math display">
\tau_a(i) =
\begin{cases}
i &amp; i = a \text{ \ or \ } a \text{ 对面的点 } \\
(2a - i) \bmod n &amp; \text{ otherwise } 
\end{cases}
</span></li>
</ul>
<div class="fragment current-visible" style="height:0">
<ul>
<li>考虑 <span class="math inline">i \neq a</span> 的情况（<span class="math inline">i = a</span> 显然封闭），若 <span class="math inline">2 \mid k</span>： <span class="math display">
\sigma_k \circ \tau_a \circ i = (2a - i + k) \bmod n = \tau_{(a + \frac{k}{2}) \bmod n}
</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>考虑 <span class="math inline">i \neq a</span> 的情况（<span class="math inline">i = a</span> 显然封闭），若 <span class="math inline">2 \nmid k</span>： <span class="math display">
\sigma_k \circ \tau_a \circ i = (2a - i + k) \bmod n = \tau_{(a + \frac{n + k}{2}) \bmod n}
</span></li>
</ul>
</div>
<aside class="notes">
<p><span class="math inline">n</span> 为偶数时，对称轴过两个点；而 <span class="math inline">n</span> 为奇数时，对称轴过一个点和一条边。</p>
<p>如果 <span class="math inline">k</span></p>
</aside>
</section>
<section class="slide level2">

<h3 id="旋转">旋转</h3>
<p><span class="math display">
G_1 = \{ \frac{2\pi}{n}, \dots, (n - 1)\frac{2\pi}{n}, 2\pi \} \quad \mid G_1 \mid = n
</span></p>
<ul>
<li>旋转 <span class="math inline">\frac{2\pi}{n}</span> 时是一个循环置换；</li>
<li>旋转 <span class="math inline">i \cdot \frac{2\pi}{n}</span> 可看作前者的 <span class="math inline">i</span> 次幂，故可拆成 <span class="math inline">\gcd(n, i)</span> 个轮换：</li>
</ul>
<p><span class="math display">
\sum\limits_{\sigma \in G} \mid \text{fix}(\sigma) \mid = \sum\limits_{i = 1}^{n} m^{\gcd(n, i)}
</span></p>
<aside class="notes">
<p>旋转 <span class="math inline">\frac{2\pi}{n}</span> 时显然只能拆成一个轮换（是一个循环置换）。回忆前面关于循环置换的幂的相关内容。</p>
<p>然而现在复杂度是 <span class="math inline">\mathcal{O}(N)</span> 的，需要借助数论知识进一步优化……</p>
</aside>
</section>
<section class="slide level2">

<p><span class="math display">
\begin{aligned}
\sum\limits_{g \in G} \mid \text{fix}(\sigma) \mid 
&amp; = \sum\limits_{i = 1}^{n} m^{\gcd(n, i)} \\
&amp; = \sum\limits_{d \mid n} m^d \sum\limits_{i = 1}^{n} [ \gcd(n, i) = d ] \\
&amp; =\sum\limits_{d \mid n} m^d \sum\limits_{i = 1}^{n} [ \gcd(\frac{n}{d}, i) = 1 ] \\
&amp; = \sum\limits_{d \mid n} m^d \cdot \varphi(\frac{n}{d})
\end{aligned}
</span></p>
<aside class="notes">
<p>复杂度变成了 <span class="math inline">\mathcal{O}(\sqrt{N})</span></p>
</aside>
</section>
<section class="slide level2">

<h3 id="翻转">翻转</h3>
<p><span class="math display">
G_2 = \{ \text{过每一条对称轴的翻转 } \} \quad \mid G_2 \mid = n
</span></p>
<ul>
<li><span class="math inline">n</span> 为偶数：
<ul>
<li><span class="math inline">\frac{n}{2}</span> 条过点的对称轴：<span class="math inline">c(g) = \frac{n}{2} + 1</span></li>
<li><span class="math inline">\frac{n}{2}</span> 条过边的对称轴：<span class="math inline">c(g) = \frac{n}{2}</span> <span class="math display">
\sum\limits_{\tau \in G_2} \mid \text{fix}(\tau) \mid 
= \frac{n}{2} \cdot m^{\frac{n}{2} + 1} + \frac{n}{2} \cdot m^{\frac{n}{2}} 
</span></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><span class="math inline">n</span> 为奇数：
<ul>
<li><span class="math inline">n</span> 条 既过点又过边的对称轴：<span class="math inline">c(g) = \frac{n + 1}{2}</span></li>
</ul>
<span class="math display">
\sum\limits_{\tau \in G_2} \mid \text{fix}(\tau) \mid 
= n \cdot m^{\frac{n + 1}{2}}
</span></li>
</ul>
</section>
<section class="slide level2">

<p><span class="math display">
\begin{aligned}
\mid M / G \mid &amp; = \frac{\sum\limits_{\sigma \in G_1} \mid \text{fix}(\sigma) \mid + \sum\limits_{\tau \in G_2} \mid \text{fix}(\tau) \mid}{\mid G_1 \mid + \mid G_2 \mid} \\
&amp; = \frac{1}{2n}\sum\limits_{d \mid n} m^d \cdot \varphi(\frac{n}{d}) \\
&amp; + \frac{1}{2n} \begin{cases}
\frac{n}{2} \cdot m^{\frac{n}{2} + 1} + \frac{n}{2} \cdot m^{\frac{n}{2}} &amp; 2 \mid n \\
n \cdot m^{\frac{n + 1}{2}} &amp; 2 \nmid n
\end{cases}
\end{aligned}
</span></p>
</section></section>
<section>
<section id="counting-undirected-graph" class="title-slide slide level1">
<h1>完全图同构计数</h1>
<p><span class="math inline">n</span> 个点无向完全图，<span class="math inline">m</span> 种颜色给边染色，求互不同构无向完全图个数。</p>
<p><span class="math inline">n \le 60, \ m \le 10^3</span></p>
<div class="fragment">
<ul>
<li>两张图若<strong>对点重标号</strong>后可以重合即为同构；</li>
<li>把边的不存在当作一种颜色可将其推广至一般无向图同构。</li>
</ul>
</div>
</section>
<section id="分析-1" class="slide level2">
<h2>分析</h2>
<ul>
<li>对点的置换群即 <span class="math inline">n</span> 阶对称群 <span class="math inline">S_n</span>，<span class="math inline">|S_n| = n!</span></li>
<li>每个点置换可以被表示成若干点轮换的乘积，而该点置换下，边两端的两点有两种情况：
<ul>
<li>在同一个轮换里；</li>
<li>在两个不同轮换里。</li>
</ul></li>
</ul>
<aside class="notes">
<p>注意接下来考虑的是轮换，那么对应的操作就是循环右移</p>
</aside>
</section>
<section class="slide level2">

<ul>
<li><p>两点在同一轮换里的边：记点轮换大小为 <span class="math inline">x</span>，则可构成 <span class="math inline">\left\lfloor \frac{x}{2} \right\rfloor</span> 个边轮换。</p>
<p>考虑 <span class="math inline">x</span> 个点构成的完全图，将点等距离放在圆周上，则显然长度相等的线段构成一个边轮换，共 <span class="math inline">\left\lfloor \frac{x}{2} \right\rfloor</span> 个。</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>两点在不同轮换里的边：记点轮换大小分别为 <span class="math inline">x, y</span>，则可构成 <span class="math inline">\gcd(x, y)</span> 个边轮换。</p>
<p>需要移 <span class="math inline">\text{lcm}(x, y)</span> 次才能转回原图形，发现每个轮换大小均为 <span class="math inline">\text{lcm}(x, y)</span>。共 <span class="math inline">xy</span> 条边，则轮换个数 <span class="math inline">\frac{xy}{\text{lcm}(x, y)} = \gcd(x, y)</span> 个。</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>对 <span class="math inline">n</span> 的每一种拆分方案：<span class="math inline">n = \sum\limits_{i = 1}^{k} t_i a_i</span>，其中 <span class="math inline">a_i</span> 代表点轮换大小，<span class="math inline">t_i</span> 为该大小的点轮换个数。则满足上述条件的点置换个数为： <span class="math display">
\frac{n!}{\prod\limits_{i = 1}^{k} t_i! \cdot a_i^{t_i}}
</span></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>其中除去 <span class="math inline">a_i^{t_i}</span> 的原因是因为每个大小为 <span class="math inline">a_i</span> 的点轮换会被重复算 <span class="math inline">a_i</span> 次。</li>
<li>爆搜所有的拆分方案即可，同一边轮换内的边都应当同色，运用一下 Pólya 定理即可。</li>
</ul>
</section></section>
<section>
<section id="icpc-2019-nanchang-j" class="title-slide slide level1">
<h1>南昌 J. Summon</h1>
<p>现要从 <span class="math inline">4</span> 种不同的水晶中取 <span class="math inline">n</span> 个围成一个圈，但有 <span class="math inline">m</span> 个限制条件：每条限制条件要求某四种水晶不能在围成的圈中连续出现。通过旋转可互相得到的方案算作一种方案，问有多少种本质不同的方案？（结果模 <span class="math inline">998244353</span>）</p>
<p><span class="math inline">n \le 10^5, m \le 256</span></p>
<aside class="notes">
<p>这其实是去年老刘专题里面一道题的稍微加强版…… 原题是要求某两种不能连续，这里改成了某四种……（POJ 2888）</p>
</aside>
</section>
<section id="分析-2" class="slide level2">
<h2>分析</h2>
<ul>
<li>由于带上了限制条件，无法直接通过 Pólya 计数法得到结果；</li>
<li>若有 <span class="math inline">m</span> 个轮换，则只需要确定前 <span class="math inline">m</span> 个水晶的颜色即可！</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>记 <span class="math inline">a\langle i, j, k, l \rangle</span> 代表是否允许 <span class="math inline">i, j, k, l</span> 四种颜色相邻；</li>
<li>记 <span class="math inline">dp\langle i, j, k, l \rangle</span> 代表 <span class="math inline">i</span> 个水晶排成一排，最后三个元素的颜色分别为 <span class="math inline">j, k, l</span>，则方案数： <span class="math display">
dp\langle i, j, k, l \rangle = \sum\limits_{s} dp \langle i - 1, s, j, k \rangle \cdot a \langle s, j, k, l \rangle
</span></li>
<li>枚举前三个水晶的颜色 <span class="math inline">\langle j, k, l \rangle</span>，则 <span class="math inline">dp \langle i + 3, j, k, l \rangle</span> 代表围成一圈时满足题目条件的不动元个数。</li>
</ul>
</section>
<section class="slide level2">

<p><span class="math display">
  dp\langle i, j, k, l \rangle = \sum\limits_{s} dp \langle i - 1, s, j, k \rangle \cdot a \langle s, j, k, l \rangle
</span></p>
<p><span class="math display">
\begin{aligned}
  \begin{bmatrix}
    dp \langle i, 1, 1, 1 \rangle \\
    dp \langle i, 1, 1, 2 \rangle \\
    \vdots \\
    dp \langle i, 4, 4, 4 \rangle
  \end{bmatrix}
\end{aligned}
=
\begin{aligned}
  \begin{bmatrix}
    dp \langle i - 1, 1, 1, 1 \rangle \\
    dp \langle i - 1, 1, 1, 2 \rangle \\
    \vdots \\
    dp \langle i - 1, 4, 4, 4 \rangle
  \end{bmatrix}
\end{aligned}
\cdot T
</span></p>
<p><span class="math display">
T[\langle s, j, k \rangle][\langle j, k, l \rangle] = a \langle s, j, k, l \rangle
</span></p>
</section>
<section class="slide level2">

<ul>
<li>旋转 <span class="math inline">i \cdot \frac{2\pi}{n}</span> 下不动元个数： <span class="math display">
\sum\limits_{\langle a, b, c \rangle} dp \langle \gcd(n, i) + 3, a, b, c \rangle
</span></li>
<li>接下来记之为 <span class="math inline">f(\gcd(n, i))</span></li>
<li>做一次矩阵快速幂即可得解，复杂度：<span class="math inline">\mathcal{O}(64^2\log{n})</span></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>不动元个数： <span class="math display">
\begin{aligned}
\sum\limits_{i = 1}^{n} f(\gcd(n, i)) 
&amp; = \sum\limits_{d \mid n} f(d) \cdot \sum\limits_{i = 1}^{n} [\gcd(n, i) = d] \\
&amp; = \sum\limits_{d \mid n} f(d) \cdot \varphi(\frac{n}{d})
\end{aligned}
</span></li>
<li>复杂度就变成了 <span class="math inline">\mathcal{O}(\sqrt{n} \cdot 64^2\log{n})</span></li>
</ul>
</section></section>
<section>
<section id="icpc-2019-yinchuan-m" class="title-slide slide level1">
<h1>银川 M. Crazy Cake</h1>
<p>圆周上均匀分布 <span class="math inline">n</span> 个点，现可连接若干点对，但要求连出的线段不可在圆内部相交（但可以在圆上相交）。经过旋转可相互得到的方案算作相同方案，有多少种本质不同方案数？（<span class="math inline">T</span> 次询问，结果模 <span class="math inline">10^9 + 7</span>）</p>
<p><span class="math display">
T \le 10^5, 2 \le n \le 10^6
</span></p>
</section>
<section id="分析-3" class="slide level2">
<h2>分析</h2>
<ul>
<li>置换群？顺时针旋转 <span class="math inline">\frac{2\pi}{n}, 2 \times \frac{2\pi}{n}, \dots, 2\pi</span>；</li>
<li>集合？所有<strong>内部不相交</strong>的方案；</li>
<li>每一种置换可表示为 <span class="math inline">\frac{n}{d}</span> 个长为 <span class="math inline">d</span> 的轮换。</li>
</ul>
</section>
<section class="slide level2">

<p><span class="math inline">d = n</span> 时的情形（即旋转 <span class="math inline">2\pi</span>）：</p>
<ul>
<li>等价于询问不考虑同构时的方案数……</li>
<li>圆周上的 <span class="math inline">n</span> 条线段不会导致相交，故先只考虑圆内部的连边……</li>
<li>记 <span class="math inline">f(n)</span> 代表 <span class="math inline">n</span> 个点只考虑<strong>内部</strong>连边的方案数，则旋转 <span class="math inline">2\pi</span> 时不动元个数为：</li>
</ul>
<p><span class="math display">
2^n \cdot f(n)
</span></p>
</section>
<section class="slide level2">

<p>首先考虑 <span class="math inline">0</span> 号点没有连边的情况：</p>
<ul>
<li>把 <span class="math inline">0</span> 号点删掉不影响答案；</li>
<li>考虑如何从 <span class="math inline">f(n - 1)</span> 转移？</li>
</ul>
</section>
<section class="slide level2">

<p><img data-src="./assets/yinchuan-m-01.png" class="plain" /></p>
<p><span class="math display">
2 \cdot f(n - 1)
</span></p>
<aside class="notes">
<p>在考虑 f(n - 1) 时，n - 2 和 n 是相邻点故我们没有考虑它们间的相邻情况；而当考虑 f(n) 是，n - 2 和 n 不是相邻点了，而这两个点是否相连都不会影响答案，所以此时方案数是 2 * f(n - 1)。</p>
</aside>
</section>
<section class="slide level2">

<p>其次考虑 <span class="math inline">0</span> 号点有连边的情况：</p>
<ul>
<li>记 <span class="math inline">0</span> 号点连出的<strong>最小标号</strong>为 <span class="math inline">i \in [1, n - 1]</span>；</li>
<li>上面这条线将图形分成了 <span class="math inline">2</span> 个部分</li>
</ul>
</section>
<section class="slide level2">

<p><img data-src="./assets/yinchuan-m-02.png" class="plain" /></p>
<p><span class="math display">
2 \cdot f(i) \cdot f(n - i + 1) \quad (i \ge 3)
</span></p>
<aside class="notes">
<p>别忘了 i = 0, 1, n - 1 是不用考虑的……</p>
<p>不清楚的话自己想想为什么 :P</p>
<p>（定义 f 的时候就把相邻点连边排除在外了）</p>
</aside>
</section>
<section class="slide level2">

<p>综上所述</p>
<p><span class="math display">
\begin{aligned}
f(n) &amp; = 2f(n - 1) \\
&amp; + f(n - 1) + 2\sum\limits_{i = 3}^{n - 2} f(i) \cdot f(n - i + 1)
\end{aligned}
</span></p>
</section>
<section class="slide level2">

<p><span class="math inline">d \neq n</span> 的情形</p>
<ul>
<li>先对每个轮换单独考虑；</li>
<li>轮换内部相邻两个点连线不会导致相交，故还是先考虑内部连边；</li>
<li>WIP</li>
</ul>
</section></section>
<section>
<section id="finale" class="title-slide slide level1">
<h1>谢谢大家</h1>

</section>
<section id="probset-1" class="slide level2">
<h2>推荐题目 - Lv1</h2>
<ul>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1817">HDU 1817: Necklace of Beads</a></li>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3547">HDU 3547: DIY Cube</a></li>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3441">HDU 3441: Rotation</a></li>
<li><a href="http://poj.org/problem?id=2888">POJ 2888: Magic Bracelet</a></li>
<li><a href="https://www.luogu.com.cn/problem/P1446">洛谷 P1446: Cards</a></li>
<li><a href="https://www.luogu.com.cn/problem/P4727">洛谷 P4727: 图的同构计数</a></li>
</ul>
</section>
<section id="probset-2" class="slide level2">
<h2>推荐题目 - Lv2</h2>
<ul>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=5080">ICPC 2014 鞍山 K: Colorful Toy</a></li>
<li><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6360">HDU 6360: Kaleidoscope</a></li>
<li><a href="https://nanti.jisuanke.com/t/42585">ICPC 2019 南昌 J: Summon</a></li>
<li><a href="https://nanti.jisuanke.com/t/42393">ICPC 2019 银川 M: Crazy Cake</a></li>
</ul>
</section></section>
    </div>
  </div>

  <script src="https://revealjs.com/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Push each slide change to the browser history
        history: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
          { src: 'https://revealjs.com/lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'https://revealjs.com/plugin/zoom-js/zoom.js', async: true },
          { src: 'https://revealjs.com/plugin/notes/notes.js', async: true }
        ]
      });
    </script>
    </body>
</html>
